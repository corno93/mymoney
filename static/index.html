<html>

<script>

  window.onload = function(){
    document.upload_form.action = get_action();
  }

  function get_action(){
      let upload_url = "/upload"
      const pathname = window.location.pathname.split("/")

      // try and append a redirect_url query param. Doing this allows the user
      // the remain on the calendar year and month even if they submitted more data
      try{
          const month = pathname[pathname.length-1]
          const year = pathname[pathname.length-3]
          const redirect_url=`/calendar/year/${year}/month/${month}`
          upload_url =  `${upload_url}?redirect=${redirect_url}`
      }catch (err){
      }
      return upload_url;
  }
</script>

<head>
  <title>MyMoney</title>
  <link href="{{ url_for('static', path='/styles.css') }}" rel="stylesheet">
</head>

<form name="upload_form" action="upload_url" method="post" enctype="multipart/form-data">
  <input type="file" name="file" accept=".csv">
  <input type="submit">
</form>


{%if calendar is defined %}
  {{ calendar|safe }}
{% endif %}

</html>